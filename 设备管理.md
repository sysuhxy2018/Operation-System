# 设备管理

### 磁盘结构

我们平常说的机械硬盘（也叫硬磁盘），实际上就属于磁盘的一种。

首先简单介绍一下磁盘的物理结构：

<img src="https://images2017.cnblogs.com/blog/1185302/201712/1185302-20171222213427318-2105425085.jpg" alt="disk" style="zoom:75%;" />

一个磁盘有多个盘面（类似于光碟一样的东西，垂直分布），每个盘面有多个带状同心环，称为磁道。磁道又被分成多个弧段，每一段称为扇区。**扇区**是最小的物理存储单位，存储容量有512字节和4096字节。另外，相邻的多组扇区可以组成簇。一般每个簇可以包括2、4、8、16、32或64个扇区。

工作的时候，主轴使盘面转动，然后磁头负责进行读写，然而这样只能读写一个磁道的内容。如果想要操作不同的磁道，需要制动手臂移动磁头。需要注意的是，每个盘面都对应一组制动手臂和磁头，负责独立操作各自的盘面。

补充一点：制动手臂是可以来回移动的，即不局限于一个方向。



### 磁盘调度算法

磁盘读写时间的影响因素有：

* 旋转时间，即主轴转动盘面，使磁头移到适当的扇区上。
* 寻道时间，即制动手臂移动，使磁头移到适当的磁道上。寻道时间耗时最久。
* 实际数据传输时间

磁盘调度算法的目标是降低平均寻道时间。

一般有下面3种算法：

* 先来先服务（FCFS）
  * 比较简单的算法，没有任何优化。
* 最短寻道时间优先（SSTF）
  * 就近原则，优先考虑与当前磁头所在磁道最近的请求磁道。
  * 缺点是容易产生饥饿现象，距离比较远的磁道容易一直等待，如最里面和最外面（两段）的磁道。
* 扫描算法（SCAN）
  * 也叫电梯算法，即总是按一个方向来调度，直到该方向上没有任何请求时逆向扫描。
  * 由于兼顾了两个方向，所以不会出现饥饿现象。
  * 需要注意的是扫描算法并不一定非要扫到两个端点，可以提前结束/转向，只要剩余部分的磁道都不是我们需要的即可。

