# 进程同步

首先介绍一个题外话：[知乎链接](https://www.zhihu.com/question/36529093)。

所以这里的“进程同步”指的是进程内部同步，也就是**线程间同步**。而对于进程间的同步，我们一般用**进程间通信**来表示，后面会讲到。

4种方式：

* 临界区
  * 对临界资源进行访问的那段代码称为临界区。
  * 临界资源指的是一次只能允许一个进程访问的资源，如打印机等等。
  * 进程在进入临界区前需要检查，如果临界资源正在被占用就无法进入临界区。
* 同步与互斥
  * 同步指的是多个进程相互**制约**，有一定的先后执行关系。
  * 互斥指多个进程在同一时刻只有一个进程能进入临界区并访问临界资源。
* 信号量(semaphore)
  * 信号量是int变量，可用于P，V操作。P，V操作不能被打断（需要屏蔽中断），称为原语。
    * 初始化：S通常会初始化为一个正整数。
    * P操作：如果S > 0，则--；S = 0，则阻塞进程，被阻塞的进程需要等待S > 0
    * V操作：S++。S加完后肯定 > 0，然后会从阻塞（等待）队列中选一个唤醒。
  * P，V操作通常都是成对出现的，一般进入临界区前P操作，离开临界区后V操作。
  * 信号量只能取值为0或1时被称为互斥锁(mutex)。
* 管程
  * 管程是一种程序结构，结构内的多个子程序形成的多个工作线程互斥访问共享资源。
  * 管程的最大特点是在同一时刻，最多只有一个线程占用该管程。该特性通过互斥锁来实现。
  * 管程中还引入了条件变量，其实它就是一个线程队列。条件变量需要在某些条件下才能执行wait和signal(notify)操作。
    * wait操作类似于P操作，用于将线程放入条件变量中等待。
    * signal操作类似于V操作，用于取出条件变量中的线程唤醒。
  * 管程在功能上等价于信号量。Java中支持和实现管程。

